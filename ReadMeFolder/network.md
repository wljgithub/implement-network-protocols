
# IP

IP 是TCP/IP协议族中最核心的协议，所有的TCP、UDP、IGMP数据都以IP数据报的格式传输。
IP主要有两个特点：

- 无连接
- 不可靠

无连接：指的是每个ip数据报都独立地进行路由跳转，可能会选择不同路由跳转，可以不按顺序接受

不可靠：指的是，ip数据报只提供传输服务，并不能保证数据报到达目的地，当出现错误时(如路由器用完缓冲区)，则发送ICMP报到信源端

### IP首部

ip首部最大为20字节，不过一般的ip首部(不含选项的)长度为5字节，来张图更直观些

![](https://github.com/wljgithub/implement_network_protocols/blob/master/ReadMeFolder/resourse/ipHead.jpg)	

下面来详细介绍下其中的字段含义：

第一行

版本：ip版本号，ipv4 or ipv6

首部长度：即为上图中的行数，一般的ip首部长度为5(不含选项)

区分服务(TOS):设置最小时延、最大吞吐量、最高可靠性、最小费用，如上层的协议Telenet需要最小传输时延，FTP需要最大吞吐量等，但大多数TCP/IP实现都不支持TOS特性

第二行

标识：

标记：

片偏移：

第三行

生存时间(TTL)：设置最大路由跳转次数

协议： 上层的协议，ICMP:1 IGMP:2  ,TCP:6 UDP:17

首部检验和：根据IP首部计算的检验和码(不含首部后的数据)，用于检验传输过程中是否出差错。如果出错，IP丢弃收到的数据报，但不生成差错报文，由上层的协议进行发现并重传


